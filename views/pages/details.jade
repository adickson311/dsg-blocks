extends ../../layouts/default

block head
  title Blocks Page

block neck
  link(rel='stylesheet', href='/views/pages/index.min.css?#{cacheBreaker}')

block feet
  //script(src='/vendor/require/require.js' data-main="vendor/dsg/main")
  script(src='/views/pages/details.js')

block body
  div.blocks-form-container
    div#header
    div#results-table
  
  script(type='text/template', id='tmpl-header')
    div.page-header
      -if (user)
        form.form-inline.pull-right
          div.input-group
            input.form-control(name='name', type='text', placeholder='enter a name')
            input.form-control(name='pageID', type='hidden', value!='<%- _id %>')
            input.form-control(name='pageName', type='hidden', value!='<%- name %>')
            button.btn.btn-primary.btn-add(type='button') Create Deal
      nav.breadcrumbs
        a(href='/') Back to pages
      h1 <%- name %>
      a.page-preview(href!='/pages/<%- _id %>/preview/') Preview
  
  script(type='text/template', id='tmpl-results-table')
    table.table.table-striped
      thead
        tr
          th.col-sm-3 Deal Name
          th.col-sm-3 Headline
          th.col-sm-4 Link
          -if (user)
            th.col-sm-1
      tbody#results-rows
  
  script(type='text/template', id='tmpl-results-row')
    td.stretch
      a(href!='/deals/<%- _id %>/') <%- name %>
    td.stretch 
      <%- headline %>
    td.nowrap
      div <%- link %>
    -if (user)
      td
        input.btn.btn-default.btn-sm.btn-details(type='button', value='Edit')
  
  script(type='text/template', id='tmpl-results-empty-row')
    tr
      td(colspan='4') no documents matched
  
  script(type='text/template', id='data-record') !{data.record}

  script(type='text/template', id='data-deals') !{data.deals}